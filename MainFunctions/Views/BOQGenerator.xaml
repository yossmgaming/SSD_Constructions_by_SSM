<UserControl x:Class="MainFunctions.Views.BOQGenerator"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:MainFunctions.Views"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
    <Grid Margin="10" x:Name="RootGrid">

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Header -->
            <RowDefinition Height="Auto"/>
            <!-- Meta -->
            <RowDefinition Height="*"/>
            <!-- BOQ Table -->
            <RowDefinition Height="Auto"/>
            <!-- Footer / Actions -->
        </Grid.RowDefinitions>

        <!-- HEADER -->
        <Border Background="White" Padding="15" CornerRadius="10" Margin="0,0,0,15">
            <!-- Use Grid for precise alignment of company info and document title/date -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="300" />
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0">
                    <TextBlock Text="SSD CONSTRUCTIONS"
                               FontSize="20"
                               FontWeight="Bold"/>
                    <TextBlock Text="136/1, Udagunnapana, Gunnapana"/>
                    <TextBlock Text="0774 286 106 / 0765 711 938"/>
                </StackPanel>

                <StackPanel Grid.Column="1" HorizontalAlignment="Right" VerticalAlignment="Center">
                    <TextBlock Text="BILL OF QUANTITIES"
                               FontSize="22"
                               FontWeight="Bold"
                               HorizontalAlignment="Right"/>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,8,0,0">
                        <TextBlock Text="Date:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                        <DatePicker x:Name="DocumentDate" Width="140" Height="26"/>
                    </StackPanel>
                </StackPanel>
            </Grid>
        </Border>

        <!-- DOCUMENT META -->
        <Grid Grid.Row="1" Margin="0,0,0,15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- TO ADDRESS -->
            <Border Background="White" Padding="10" CornerRadius="10" Margin="0,0,10,0">
                <StackPanel>
                    <TextBlock Text="To:" FontWeight="Bold"/>
                    <TextBox x:Name="ToAddressTextBox" AcceptsReturn="True" Height="100"
                             Text=""/>
                </StackPanel>
            </Border>

            <!-- PROJECT INFO -->
            <Border Grid.Column="1" Background="White" Padding="10" CornerRadius="10">
                <StackPanel>
                    <TextBlock Text="Project Title" FontWeight="Bold"/>
                    <TextBox x:Name="ProjectTitleTextBox" Margin="0,5,0,10"
                             Text=""/>

                    <TextBlock Text="Notes"/>
                    <TextBox x:Name="BoqNotesTextBox" AcceptsReturn="True" Height="60"/>
                </StackPanel>
            </Border>
        </Grid>

        <!-- BOQ TABLE -->
        <Border Grid.Row="2" Background="White" Padding="10" CornerRadius="10">
            <StackPanel>
                <!-- Input row: labels and textboxes -->
                <Grid Margin="0,0,0,10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="60"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition Width="120"/>
                        <ColumnDefinition Width="140"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Labels -->
                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Item" FontWeight="SemiBold" Margin="0,0,6,4"/>
                    <TextBlock Grid.Row="0" Grid.Column="1" Text="Description" FontWeight="SemiBold" Margin="0,0,6,4"/>
                    <TextBlock Grid.Row="0" Grid.Column="2" Text="Qty" FontWeight="SemiBold" Margin="0,0,6,4"/>
                    <TextBlock Grid.Row="0" Grid.Column="3" Text="Unit" FontWeight="SemiBold" Margin="0,0,6,4"/>
                    <TextBlock Grid.Row="0" Grid.Column="4" Text="Rate" FontWeight="SemiBold" Margin="0,0,6,4"/>
                    <TextBlock Grid.Row="0" Grid.Column="5" Text="Amount" FontWeight="SemiBold" Margin="0,0,6,4"/>

                    <!-- Inputs -->
                    <TextBox x:Name="InputItemNo" Grid.Row="1" Grid.Column="0" Height="28" PreviewKeyDown="InputField_PreviewKeyDown" SpellCheck.IsEnabled="False" InputMethod.IsInputMethodEnabled="False"/>
                    <TextBox x:Name="InputDescription" Grid.Row="1" Grid.Column="1" Height="60" AcceptsReturn="True" TextWrapping="Wrap" PreviewKeyDown="InputField_PreviewKeyDown" SpellCheck.IsEnabled="False" InputMethod.IsInputMethodEnabled="False"/>
                    <TextBox x:Name="InputQuantity" Grid.Row="1" Grid.Column="2" Height="28" PreviewKeyDown="InputField_PreviewKeyDown" SpellCheck.IsEnabled="False" InputMethod.IsInputMethodEnabled="False"/>
                    <ComboBox x:Name="InputUnit" Grid.Row="1" Grid.Column="3" Height="28" PreviewKeyDown="InputField_PreviewKeyDown" IsEditable="False" IsTextSearchEnabled="False">
                        <ComboBoxItem>sq/ft</ComboBoxItem>
                        <ComboBoxItem>l/ft</ComboBoxItem>
                        <ComboBoxItem>cu/ft</ComboBoxItem>
                        <ComboBoxItem>sqr</ComboBoxItem>
                        <ComboBoxItem>cube</ComboBoxItem>
                        <ComboBoxItem>cu/meter</ComboBoxItem>
                        <ComboBoxItem>item</ComboBoxItem>
                        <ComboBoxItem>sum</ComboBoxItem>
                        <ComboBoxItem>nos</ComboBoxItem>
                    </ComboBox>
                    <TextBox x:Name="InputRate" Grid.Row="1" Grid.Column="4" Height="28" PreviewKeyDown="InputField_PreviewKeyDown" SpellCheck.IsEnabled="False" InputMethod.IsInputMethodEnabled="False"/>
                    <TextBox x:Name="InputAmount" Grid.Row="1" Grid.Column="5" Height="28" IsReadOnly="True" PreviewKeyDown="InputField_PreviewKeyDown" SpellCheck.IsEnabled="False" InputMethod.IsInputMethodEnabled="False"/>

                    <!-- Action buttons for design (Add/Update/Delete/Clear) -->
                    <StackPanel Grid.Row="1" Grid.Column="6" Orientation="Vertical" HorizontalAlignment="Right">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button x:Name="BOQAddButton" Content="Add" Width="70" Height="28" Margin="0,0,6,0"/>
                            <Button x:Name="BOQUpdateButton" Content="Update" Width="70" Height="28" Margin="0,0,6,0"/>
                            <Button x:Name="BOQDeleteButton" Content="Delete" Width="70" Height="28" Margin="0,0,6,0"/>
                            <Button x:Name="BOQClearButton" Content="Clear" Width="70" Height="28"/>
                        </StackPanel>
                        <Button x:Name="SaveBoqButton" Content="Save BOQ" Width="150" Height="28" Margin="0,8,0,0"/>
                    </StackPanel>
                </Grid>

                <!-- DataGrid -->
                <DataGrid x:Name="BOQGrid"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          HeadersVisibility="Column"
                          Height="300">

                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Item" Width="60"
                                            Binding="{Binding ItemNo}"/>
                        <DataGridTextColumn Header="Description" Width="*"
                                            Binding="{Binding Description}"/>
                        <DataGridTextColumn Header="Qty" Width="80"
                                            Binding="{Binding Quantity, StringFormat=N2}"/>
                        <DataGridTextColumn Header="Unit" Width="80"
                                            Binding="{Binding Unit}"/>
                        <DataGridTextColumn Header="Rate" Width="120"
                                            Binding="{Binding Rate, StringFormat=N2}"/>
                        <DataGridTextColumn Header="Amount" Width="140"
                                            Binding="{Binding Amount, StringFormat=N2}" IsReadOnly="True"/>
                    </DataGrid.Columns>

                </DataGrid>
            </StackPanel>
        </Border>

        <!-- FOOTER / TOTALS -->
        <Grid Grid.Row="3" Margin="0,15,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel>
                <TextBlock Text="SSD CONSTRUCTIONS - CPC/DS/KU/4717"/>
                <TextBlock Text="ssdconstructions2020@gmail.com"/>
            </StackPanel>

            <StackPanel Grid.Column="1" HorizontalAlignment="Right">
                <TextBlock Text="Grand Total"
                           FontWeight="Bold"
                           FontSize="14"
                           HorizontalAlignment="Right"/>
                <TextBlock x:Name="GrandTotalText" Text="LKR 0.00"
                           FontSize="20"
                           FontWeight="Bold"
                           HorizontalAlignment="Right"/>
                <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                    <Button x:Name="ExportPdfButton" Content="Export PDF" Width="100" Margin="0,0,10,0"/>
                    <Button x:Name="ExportExcelButton" Content="Export Excel" Width="110"/>
                </StackPanel>
            </StackPanel>
        </Grid>
    </Grid>
</UserControl>
